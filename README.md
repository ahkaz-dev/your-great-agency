# Great Ageny

## Общее описание

Great Ageny — это автономный агент, который управляет браузером на базе Chromium через Playwright. Агент принимает естественноязыковые задачи через терминал CLI, сам планирует, рассуждает, выполняет действия в браузере, наблюдает и итеративно работает до завершения.

**Ключевая особенность:** Агент адаптивно решает задачи.

## Основной функционал

### 1. Автоматизация браузера
- **Playwright** с надежными действиями
- Динамический синтез селекторов на основе LLM
- Умное взаимодействие с веб-элементами с учетом семантики

### 2. Цикл автономии
- **Planner + Executor + Critic**
- Критик выполняет саморефлексию для обнаружения циклов
- Короткосрочная рабочая память

### 3. Управление контекстом
- Сжатие наблюдений
- Поддержание релевантного окна истории
- Резюмирование доступных инструментов

### 4. Продвинутые паттерны
- Иерархическое планирование с разбивкой на вехи
- ReAct для пошагового решения задач
- Механизм прерывания при необходимости ввода от пользователя

### 5. Безопасность
- Бюджет навигации и действий
- Защита от бесконечных циклов
- Опциональные ограничения доменов

## Технические требования

### Перед началом работы
1. **Node.js** версии 18 или выше
2. **Python** версии 3.10 или выше

### Установка и запуск

#### Шаг 1: Клонируйте репозиторий
```bash
git clone <repository-url>
cd your-greay-agency
```

#### Шаг 2: Установите зависимости
```bash
npm install
```

#### Шаг 3: Установите браузеры Playwright
```bash
npx playwright install --with-deps
```

#### Шаг 4: Настройте переменные окружения
Создайте файл `.env` на основе `.env.example`:
```bash
cp .env.example .env
```

Отредактируйте `.env` файл:
```env
# LLM настройки (OpenAI-compatible API)
LLM_BASE_URL=https://api.openai.com/v1
LLM_API_KEY=ваш-api-ключ
LLM_MODEL=gpt-4o-mini

# Опционально: разрешенные домены (через запятую)
ALLOWED_HOSTS=
```

### Настройка локальных моделей
Для использования локальных моделей (например, Ollama):
```env
LLM_BASE_URL=http://localhost:11434/v1
LLM_MODEL=ваша-модель
```

#### Шаг 5: Запуск

**Вариант 1: Веб-интерфейс (UI)**
```bash
npm run agent "Найди и обобщи 3 новости о квантовых вычислениях из авторитетных источников."
```

## Структура проекта

```
ai-browser-agent/
├── .env                    # Файл переменных окружения
├── .env.example           # Пример файла переменных окружения
├── package.json          # Зависимости и скрипты проекта
├── package-lock.json     # Блокировка версий зависимостей
├── tsconfig.json         # Конфигурация TypeScript
├── playwright.config.ts   # Конфигурация Playwright
├── src/                  # Исходный код
│   ├── index.ts          # Точка входа, оркестрация UI сервера и агента
│   ├── agent/            # Логика агента
│   │   ├── core.ts       # Основной цикл агента (Planner/Executor/Critic)
│   │   ├── llm.ts        # Абстракция LLM (OpenAI-compatible API)
│   │   ├── tools.ts      # Инструменты браузера для агента
│   │   ├── selectors.ts  # Динамическое обнаружение и оценка селекторов
│   │   └── memory.ts     # Управление контекстом и памятью
│   ├── browser/          # Управление браузером
│   │   └── controller.ts # Playwright обертка для надежных взаимодействий
│   └── server/           # Серверная часть
│       ├── server.ts     # Fastify сервер для API + WebSocket потоковая передача логов
│       ├── vite.config.ts # Конфигурация Vite
│       └── ui/           # Клиентская часть Vite + Vanilla TS
│           ├── index.html
│           ├── main.ts
│           └── style.css
└── dist/                 # Скомпилированный код (создается при сборке)
```

## Конфигурация LLM

Проект использует OpenAI-совместимый HTTP API для работы с языковыми моделями.

## Запуск тестов

```bash
npm run playwright
```

## Сборка проекта

```bash
npm run build
```
